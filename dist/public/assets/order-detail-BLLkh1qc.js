import{j as e,u as Ge,a as T,X as ae,b as d,q as l}from"./index-Bn_nBLti.js";import{r as m}from"./react-vendor-DoqEe0id.js";import{b as _e,u as Xe}from"./react-router-CfqK1w0z.js";import{u as N,L}from"./checkbox-BMTmXFyU.js";import{B as n}from"./button-CefpbQ8d.js";import{C as y,a as V,b as A,c as I}from"./card-CdR82dfq.js";import{B as O,I as k,f as c}from"./badge-COQmasRY.js";import{S as P}from"./separator-DOVSrcv_.js";import{D as q,b as K,c as F,d as $,m as w,S as De,P as ne,a as R,A as We,M as Je,G as je,g as Ye,r as Ze,U as er}from"./radio-group-CqarH3lg.js";import{S as Ce,a as Se,b as Te,c as Ae,d as oe}from"./select-Dq-Kscc-.js";import{H as rr,A as sr,x as ir,P as tr,C as ar,K as nr,G as lr,F as or,I as cr,E as ye,B as mr}from"./PaymentForm-BI-5Htr3.js";import{A as le}from"./arrow-left-D0MiDmV7.js";import{C as ur,P as dr}from"./package-VsadMZkF.js";import{C as G}from"./check-BNpeBMQG.js";import{T as pr,C as Ve}from"./trash-2-Dfm-7jq-.js";import{U as M}from"./users-C3iDr7PO.js";import"./ui-lib-De9q200A.js";import"./skeleton-Cttip_U4.js";import"./star-rZ6EHPiU.js";function Nr({open:h,onOpenChange:u,totalAmount:t,paidAmount:i=0,isSubmitting:g,onSubmit:v,title:D="Registrar Pagamento"}){return e.jsxDEV(q,{open:h,onOpenChange:u,children:e.jsxDEV(K,{children:[e.jsxDEV(F,{children:e.jsxDEV($,{children:D},void 0,!1,{fileName:"/home/runner/workspace/client/src/components/PaymentDialog.tsx",lineNumber:19,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/components/PaymentDialog.tsx",lineNumber:18,columnNumber:9},this),e.jsxDEV(rr,{onSubmit:v,totalAmount:t,paidAmount:i,isPending:g,allowSplit:!1},void 0,!1,{fileName:"/home/runner/workspace/client/src/components/PaymentDialog.tsx",lineNumber:21,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/components/PaymentDialog.tsx",lineNumber:17,columnNumber:7},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/components/PaymentDialog.tsx",lineNumber:16,columnNumber:5},this)}const Pe={pendente:"bg-chart-4 text-chart-4-foreground",em_preparo:"bg-chart-2 text-chart-2-foreground",pronto:"bg-chart-3 text-chart-3-foreground",servido:"bg-muted text-muted-foreground"},hr={pendente:"Pendente",em_preparo:"Em Preparo",pronto:"Pronto",servido:"Servido"},br={mesa:"Mesa",delivery:"Delivery",takeout:"Retirada",balcao:"Balc√£o",pdv:"PDV"};function zr(){var ke,Ee;const[,h]=_e("/orders/:id"),[,u]=Xe(),t=h==null?void 0:h.id,{toast:i}=Ge(),{getPrinterByType:g}=sr(),v=typeof window<"u"&&window.location.search.includes("mode=checkout"),[D,b]=m.useState(!1),[Ie,_]=m.useState(!1),[ce,X]=m.useState(""),[me,W]=m.useState(""),[ue,J]=m.useState(""),[qe,Ke]=m.useState(0),[Fe,C]=m.useState(!1),[$e,Y]=m.useState(!1),[Qe,Z]=m.useState(!1),[ee,re]=m.useState(""),[B,de]=m.useState(""),[se,pe]=m.useState(""),[Q,Ne]=m.useState(0),{data:r,isLoading:ze}=T({queryKey:["/api/orders",t],enabled:!!t}),{data:Oe=[]}=T({queryKey:["/api/menu-items"]}),{data:he=[]}=T({queryKey:["/api/customers"]}),{data:E}=T({queryKey:["/api/loyalty","program"]}),{data:x}=T({queryKey:[`/api/tables/${r==null?void 0:r.tableId}/orders-by-guest`],enabled:!!(r!=null&&r.tableId)&&((r==null?void 0:r.orderType)==="mesa"||(r==null?void 0:r.tableId)!==null)}),{data:ie}=T({queryKey:[`/api/public/restaurants/${r==null?void 0:r.restaurantId}`],enabled:!!(r!=null&&r.restaurantId)}),p=he.find(s=>s.id===(B||(r==null?void 0:r.customerId))),be=(x==null?void 0:x.ordersByGuest)&&x.ordersByGuest.length>0;m.useEffect(()=>{r&&(X(r.orderTitle||""),W(r.customerName||""),J(r.customerPhone||""),v&&r.paymentStatus!=="pago"&&r.orderItems.length>0&&setTimeout(()=>C(!0),500))},[r,v]),m.useEffect(()=>{if(!(r!=null&&r.createdAt))return;const s=setInterval(()=>{const a=new Date().getTime(),o=new Date(r.createdAt).getTime(),f=Math.floor((a-o)/1e3);Ke(f)},1e3);return()=>clearInterval(s)},[r==null?void 0:r.createdAt]),m.useEffect(()=>{const s=a=>{if(!(a.target instanceof HTMLInputElement||a.target instanceof HTMLTextAreaElement)){if(a.key==="Escape")u("/pdv");else if(a.key==="F2")a.preventDefault(),r&&r.orderItems.length>0&&r.paymentStatus!=="pago"&&C(!0);else if(a.key==="F3"){a.preventDefault();const o=document.querySelector('[data-testid="button-discount"]');o==null||o.click()}}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[r,u]);const xe=N({mutationFn:async s=>(await d("PUT",`/api/orders/${t}/metadata`,s)).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Atualizado com sucesso"}),b(!1),_(!1)},onError:()=>{i({title:"Erro ao atualizar",variant:"destructive"})}}),Re=N({mutationFn:async s=>(await d("POST",`/api/orders/${t}/items`,s)).json(),onSuccess:(s,a)=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]});const o=Oe.find(f=>f.id===a.menuItemId);i({title:"‚úì Item adicionado",description:`${a.quantity}x ${(o==null?void 0:o.name)||"Produto"}`}),Y(!1)},onError:()=>{i({title:"Erro ao adicionar item",variant:"destructive"})}}),fe=N({mutationFn:async s=>(await d("DELETE",`/api/orders/${t}/items/${s}`)).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Item removido",description:"O produto foi removido do pedido"})},onError:()=>{i({title:"Erro ao remover item",variant:"destructive"})}}),ge=N({mutationFn:async({itemId:s,quantity:a})=>(await d("PUT",`/api/orders/${t}/items/${s}`,{quantity:a})).json(),onSuccess:(s,a)=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Quantidade atualizada",description:`Nova quantidade: ${a.quantity}`,duration:1500})},onError:()=>{i({title:"Erro ao atualizar quantidade",variant:"destructive"})}}),Me=N({mutationFn:async s=>(await d("PUT",`/api/orders/${t}/discount`,s)).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Desconto aplicado"})},onError:()=>{i({title:"Erro ao aplicar desconto",variant:"destructive"})}}),Le=N({mutationFn:async s=>(await d("PUT",`/api/orders/${t}/service-charge`,s)).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Taxa de servi√ßo aplicada"})},onError:()=>{i({title:"Erro ao aplicar taxa de servi√ßo",variant:"destructive"})}}),Be=N({mutationFn:async s=>(await d("PUT",`/api/orders/${t}/packaging-fee`,{packagingFee:s})).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Taxa de embalagem aplicada"})},onError:()=>{i({title:"Erro ao aplicar taxa de embalagem",variant:"destructive"})}}),ve=N({mutationFn:async s=>(await d("PUT",`/api/orders/${t}/customer`,{customerId:s})).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),l.invalidateQueries({queryKey:["/api/customers"]}),i({title:"Cliente vinculado"})},onError:()=>{i({title:"Erro ao vincular cliente",variant:"destructive"})}}),te=N({mutationFn:async s=>{var o;return(await d("POST",`/api/orders/${t}/coupon`,{code:s,orderValue:((o=r==null?void 0:r.totalAmount)==null?void 0:o.toString())||"0"})).json()},onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Cupom aplicado"}),pe("")},onError:s=>{i({title:"Erro ao aplicar cupom",description:s.message||"Cupom inv√°lido ou expirado",variant:"destructive"})}}),we=N({mutationFn:async s=>(await d("POST",`/api/orders/${t}/loyalty/redeem`,{points:s,customerId:B||(r==null?void 0:r.customerId)})).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),l.invalidateQueries({queryKey:["/api/customers"]}),i({title:"Pontos resgatados"}),Ne(0)},onError:s=>{i({title:"Erro ao resgatar pontos",description:s.message||"Pontos insuficientes",variant:"destructive"})}}),S=N({mutationFn:async s=>(await d("POST",`/api/orders/${t}/payments`,s)).json(),onSuccess:async s=>{var f;l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),l.invalidateQueries({queryKey:[`/api/tables/${r==null?void 0:r.tableId}/orders-by-guest`]}),i({title:"Pagamento registrado"}),C(!1);const a=localStorage.getItem("auto-print-receipt")==="true",o=g("receipt");if(a&&o&&r)try{await mr.printReceipt("receipt",{title:"RECIBO DE PAGAMENTO",items:((f=r.orderItems)==null?void 0:f.map(j=>{var H;return{name:((H=j.menuItem)==null?void 0:H.name)||"Item",quantity:j.quantity,price:c(j.price)}}))||[],subtotal:c(r.totalAmount),discount:r.discount?c(r.discount):void 0,total:c(r.totalAmount),footer:`Obrigado pela prefer√™ncia!
${new Date().toLocaleString("pt-AO")}`}),i({title:"Recibo impresso",description:"Recibo enviado para impressora"})}catch(j){console.error("Erro ao imprimir recibo:",j)}},onError:s=>{i({title:"Erro ao registrar pagamento",description:s.message||"N√£o foi poss√≠vel registrar o pagamento.",variant:"destructive"})}}),U=async(s,a)=>{var o;if(r!=null&&r.tableId)try{const f=(o=x==null?void 0:x.ordersByGuest)==null?void 0:o.find(H=>H.guest.id===s);if(!f)return;const j=(f.totalAmount||0).toFixed(2);await d("POST",`/api/tables/${r.tableId}/payment`,{amount:j,paymentMethod:a}),await d("PATCH",`/api/tables/${r.tableId}/guests/${s}`,{status:"pago"}),l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:[`/api/tables/${r.tableId}/orders-by-guest`]}),l.invalidateQueries({queryKey:["/api/tables"]}),i({title:"Pagamento registrado",description:`Pagamento de ${c(j)} registrado.`})}catch(f){i({title:"Erro ao registrar pagamento",description:f.message||"N√£o foi poss√≠vel registrar o pagamento.",variant:"destructive"})}},Ue=N({mutationFn:async s=>(await d("PATCH",`/api/orders/${t}/status`,{status:s})).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),i({title:"Status atualizado"})},onError:()=>{i({title:"Erro ao atualizar status",variant:"destructive"})}}),z=N({mutationFn:async s=>(await d("POST",`/api/orders/${t}/cancel`,{cancellationReason:s})).json(),onSuccess:()=>{l.invalidateQueries({queryKey:["/api/orders",t]}),l.invalidateQueries({queryKey:["/api/orders"]}),l.invalidateQueries({queryKey:["/api/customers"]}),i({title:"Pedido cancelado com sucesso",description:"Todos os estornos foram processados"}),Z(!1),re("")},onError:s=>{i({title:"Erro ao cancelar pedido",description:s.message||"N√£o foi poss√≠vel cancelar o pedido",variant:"destructive"})}}),He=s=>{const a=Math.floor(s/60),o=s%60;return`${a.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`};return ze?e.jsxDEV("div",{className:"flex items-center justify-center h-screen",children:e.jsxDEV("p",{className:"text-muted-foreground",children:"Carregando..."},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:493,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:492,columnNumber:7},this):r?e.jsxDEV("div",{className:"flex flex-col h-screen",children:[e.jsxDEV(w.div,{className:"border-b p-4 flex items-center gap-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxDEV(n,{variant:"ghost",size:"icon",onClick:()=>u("/pdv"),"data-testid":"button-back",children:e.jsxDEV(le,{className:"h-5 w-5"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:524,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:518,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(O,{className:Pe[r.orderType]||"bg-muted",children:br[r.orderType]||r.orderType},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:527,columnNumber:11},this),e.jsxDEV("span",{className:"text-sm text-muted-foreground",children:["#",r.id.slice(0,8).toUpperCase()]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:530,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:526,columnNumber:9},this),e.jsxDEV(P,{orientation:"vertical",className:"h-6"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:532,columnNumber:9},this),e.jsxDEV(w.div,{animate:{scale:[1,1.05,1]},transition:{duration:2,repeat:1/0,repeatDelay:3},children:e.jsxDEV(O,{className:Pe[r.status],children:hr[r.status]},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:543,columnNumber:11},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:533,columnNumber:9},this),e.jsxDEV("div",{className:"ml-auto flex items-center gap-4",children:[e.jsxDEV("div",{className:"text-sm text-muted-foreground",children:r.createdAt&&ir(new Date(r.createdAt),"dd/MM/yy HH:mm")},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:548,columnNumber:11},this),e.jsxDEV(O,{variant:"secondary",className:"gap-2",children:[e.jsxDEV(ur,{className:"h-3 w-3"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:552,columnNumber:13},this),He(qe)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:551,columnNumber:11},this),e.jsxDEV(tr,{order:r,variant:"ghost",size:"icon"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:555,columnNumber:11},this),e.jsxDEV(ar,{order:r,variant:"ghost",size:"icon"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:560,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:547,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:512,columnNumber:7},this),e.jsxDEV("div",{className:"border-b bg-muted/30 px-4 py-2 flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV("kbd",{className:"px-2 py-1 bg-background border rounded",children:"ESC"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:570,columnNumber:11},this),e.jsxDEV("span",{children:"Voltar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:571,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:569,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV("kbd",{className:"px-2 py-1 bg-background border rounded",children:"F2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:574,columnNumber:11},this),e.jsxDEV("span",{children:"Pagar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:575,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:573,columnNumber:9},this),e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV("kbd",{className:"px-2 py-1 bg-background border rounded",children:"F3"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:578,columnNumber:11},this),e.jsxDEV("span",{children:"Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:579,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:577,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:568,columnNumber:7},this),e.jsxDEV(De,{className:"flex-1",children:e.jsxDEV("div",{className:"p-6 space-y-4",children:[e.jsxDEV(y,{children:e.jsxDEV(V,{className:"p-4",children:e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:D?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(k,{value:ce,onChange:s=>X(s.target.value),placeholder:"Adicionar t√≠tulo","data-testid":"input-order-title",className:"flex-1"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:591,columnNumber:23},this),e.jsxDEV(n,{size:"icon",variant:"ghost",onClick:()=>xe.mutate({orderTitle:ce}),"data-testid":"button-save-title",children:e.jsxDEV(G,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:604,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:598,columnNumber:23},this),e.jsxDEV(n,{size:"icon",variant:"ghost",onClick:()=>{b(!1),X(r.orderTitle||"")},"data-testid":"button-cancel-title",children:e.jsxDEV(ae,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:615,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:606,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:590,columnNumber:21},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV("span",{className:"text-muted-foreground flex-1",children:r.orderTitle||"Adicionar t√≠tulo"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:620,columnNumber:23},this),e.jsxDEV(n,{size:"icon",variant:"ghost",onClick:()=>b(!0),"data-testid":"button-edit-title",children:e.jsxDEV(nr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:629,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:623,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:619,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:588,columnNumber:17},this),e.jsxDEV("div",{className:"text-sm text-muted-foreground",children:["AO-",r.id.slice(0,10).toUpperCase()]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:635,columnNumber:17},this),e.jsxDEV(P,{},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:639,columnNumber:17},this),e.jsxDEV("div",{className:"space-y-2",children:Ie?e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(k,{value:me,onChange:s=>W(s.target.value),placeholder:"Nome do cliente","data-testid":"input-customer-name"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:644,columnNumber:23},this),e.jsxDEV(k,{value:ue,onChange:s=>J(s.target.value),placeholder:"Telefone do cliente","data-testid":"input-customer-phone"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:650,columnNumber:23},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(n,{size:"sm",onClick:()=>xe.mutate({customerName:me,customerPhone:ue}),"data-testid":"button-save-customer",children:[e.jsxDEV(G,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:662,columnNumber:27},this),"Salvar"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:657,columnNumber:25},this),e.jsxDEV(n,{size:"sm",variant:"ghost",onClick:()=>{_(!1),W(r.customerName||""),J(r.customerPhone||"")},"data-testid":"button-cancel-customer",children:[e.jsxDEV(ae,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:675,columnNumber:27},this),"Cancelar"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:665,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:656,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:643,columnNumber:21},this):e.jsxDEV(n,{variant:"ghost",className:"w-full justify-start text-muted-foreground",onClick:()=>_(!0),"data-testid":"button-add-customer",children:r.customerName||"Adicionar um nome de cliente"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:681,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:641,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:587,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:586,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:585,columnNumber:11},this),e.jsxDEV(y,{children:[e.jsxDEV(A,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxDEV(I,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsxDEV(ne,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:698,columnNumber:17},this),"Produtos"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:697,columnNumber:15},this),e.jsxDEV(q,{open:$e,onOpenChange:Y,children:[e.jsxDEV(R,{asChild:!0,children:e.jsxDEV(n,{variant:"ghost",size:"sm","data-testid":"button-add-product",children:e.jsxDEV(ne,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:704,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:703,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:702,columnNumber:17},this),e.jsxDEV(K,{className:"max-w-6xl max-h-[90vh] p-6",children:[e.jsxDEV(F,{children:e.jsxDEV($,{children:"Adicionar Produtos ao Pedido"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:709,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:708,columnNumber:19},this),e.jsxDEV(De,{className:"h-[calc(90vh-8rem)]",children:e.jsxDEV(lr,{onAddToOrder:s=>Re.mutate(s),onClose:()=>Y(!1)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:712,columnNumber:21},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:711,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:707,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:701,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:696,columnNumber:13},this),e.jsxDEV(V,{children:r.orderItems.length===0?e.jsxDEV("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"Adicione produtos antes de aceitar o pedido"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:722,columnNumber:17},this):e.jsxDEV("div",{className:"space-y-2",children:e.jsxDEV(We,{mode:"popLayout",children:r.orderItems.map((s,a)=>e.jsxDEV(w.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{duration:.2,delay:a*.03},className:"flex items-center gap-2 p-3 rounded-md bg-muted/50 hover-elevate",children:[e.jsxDEV("div",{className:"flex items-center gap-2 flex-1",children:[e.jsxDEV("div",{className:"flex items-center gap-1 bg-background rounded-md p-1 border",children:[e.jsxDEV(n,{size:"icon",variant:"ghost",className:"h-7 w-7 hover:bg-destructive/10 hover:text-destructive active-elevate-2",onClick:()=>{s.quantity>1?ge.mutate({itemId:s.id,quantity:s.quantity-1}):fe.mutate(s.id)},"data-testid":`decrease-item-${s.id}`,children:e.jsxDEV(Je,{className:"h-3 w-3"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:752,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:739,columnNumber:29},this),e.jsxDEV("span",{className:"min-w-[2rem] text-center font-semibold","data-testid":`item-quantity-${s.id}`,children:s.quantity},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:754,columnNumber:29},this),e.jsxDEV(n,{size:"icon",variant:"ghost",className:"h-7 w-7 hover:bg-primary/10 hover:text-primary active-elevate-2",onClick:()=>ge.mutate({itemId:s.id,quantity:s.quantity+1}),"data-testid":`increase-item-${s.id}`,children:e.jsxDEV(ne,{className:"h-3 w-3"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:764,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:757,columnNumber:29},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:738,columnNumber:27},this),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("p",{className:"font-medium",children:s.menuItem.name},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:768,columnNumber:29},this),s.notes&&e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:s.notes},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:770,columnNumber:31},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:767,columnNumber:27},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:737,columnNumber:25},this),e.jsxDEV("span",{className:"font-semibold text-lg",children:c(Number(s.price)*s.quantity)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:774,columnNumber:25},this),e.jsxDEV(n,{size:"icon",variant:"ghost",className:"h-8 w-8 hover:bg-destructive/10 hover:text-destructive active-elevate-2",onClick:()=>fe.mutate(s.id),"data-testid":`remove-item-${s.id}`,children:e.jsxDEV(pr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:782,columnNumber:27},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:775,columnNumber:25},this)]},s.id,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:729,columnNumber:23},this))},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:727,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:726,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:720,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:695,columnNumber:11},this),e.jsxDEV(y,{children:[e.jsxDEV(A,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsxDEV(I,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsxDEV(M,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:795,columnNumber:17},this),"Cliente"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:794,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:793,columnNumber:13},this),e.jsxDEV(V,{children:r.customerId||B?e.jsxDEV(w.div,{className:"space-y-3",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:[e.jsxDEV("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-gradient-to-r from-primary/5 to-primary/10 border border-primary/20",children:[e.jsxDEV("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:e.jsxDEV(M,{className:"h-5 w-5 text-primary"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:808,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:807,columnNumber:21},this),e.jsxDEV("div",{className:"flex-1 min-w-0",children:[e.jsxDEV("p",{className:"font-semibold truncate",children:p==null?void 0:p.name},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:811,columnNumber:23},this),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:(p==null?void 0:p.phone)||"Sem telefone"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:812,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:810,columnNumber:21},this),e.jsxDEV(n,{size:"icon",variant:"ghost",className:"h-8 w-8 flex-shrink-0 hover:bg-destructive/10 hover:text-destructive",onClick:()=>{de(""),ve.mutate("")},"data-testid":"button-remove-customer",children:e.jsxDEV(ae,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:824,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:814,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:806,columnNumber:19},this),p&&e.jsxDEV("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(je,{className:"h-4 w-4 text-primary"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:830,columnNumber:25},this),e.jsxDEV("span",{className:"text-sm font-medium",children:[p.loyaltyPoints||0," pontos"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:831,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:829,columnNumber:23},this),e.jsxDEV(O,{variant:"secondary",className:"capitalize",children:p.tier||"bronze"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:833,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:828,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:801,columnNumber:17},this):e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(Ce,{value:B,onValueChange:s=>{de(s),ve.mutate(s)},children:[e.jsxDEV(Se,{"data-testid":"select-customer",className:"h-12",children:e.jsxDEV(Te,{placeholder:"üîç Pesquisar ou selecionar cliente..."},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:849,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:848,columnNumber:21},this),e.jsxDEV(Ae,{children:he.map(s=>e.jsxDEV(oe,{value:s.id,children:e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(M,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:855,columnNumber:29},this),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-medium",children:s.name},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:857,columnNumber:31},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:s.phone||"Sem telefone"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:858,columnNumber:31},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:856,columnNumber:29},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:854,columnNumber:27},this)},s.id,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:853,columnNumber:25},this))},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:851,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:841,columnNumber:19},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground text-center",children:"Vincule um cliente para usar cupons e pontos de fidelidade"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:865,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:840,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:799,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:792,columnNumber:11},this),e.jsxDEV(y,{children:[e.jsxDEV(A,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsxDEV(I,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsxDEV(Ye,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:876,columnNumber:17},this),"Cupom de Desconto"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:875,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:874,columnNumber:13},this),e.jsxDEV(V,{children:r.couponId?e.jsxDEV("div",{className:"flex items-center justify-between p-2 rounded-md bg-success/10 border border-success",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(G,{className:"h-4 w-4 text-success"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:884,columnNumber:21},this),e.jsxDEV("span",{className:"font-medium text-success",children:"Cupom aplicado"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:885,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:883,columnNumber:19},this),e.jsxDEV("span",{className:"text-sm text-muted-foreground",children:["-",c(r.couponDiscount||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:887,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:882,columnNumber:17},this):e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(k,{placeholder:"C√≥digo do cupom",value:se,onChange:s=>pe(s.target.value.toUpperCase()),"data-testid":"input-coupon-code"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:891,columnNumber:19},this),e.jsxDEV(n,{onClick:()=>te.mutate(se),disabled:!se||te.isPending,"data-testid":"button-apply-coupon",children:te.isPending?"Validando...":"Aplicar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:897,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:890,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:880,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:873,columnNumber:11},this),(E==null?void 0:E.isActive)===1&&p&&e.jsxDEV(y,{children:[e.jsxDEV(A,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsxDEV(I,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsxDEV(je,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:913,columnNumber:19},this),"Programa de Fidelidade"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:912,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:911,columnNumber:15},this),e.jsxDEV(V,{className:"space-y-3",children:[e.jsxDEV("div",{className:"flex items-center justify-between p-2 rounded-md bg-muted/50",children:[e.jsxDEV("span",{className:"text-sm",children:"Pontos dispon√≠veis"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:919,columnNumber:19},this),e.jsxDEV("span",{className:"font-semibold",children:[p.loyaltyPoints||0," pts"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:920,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:918,columnNumber:17},this),(r.loyaltyPointsRedeemed||0)>0&&e.jsxDEV("div",{className:"flex items-center justify-between p-2 rounded-md bg-success/10 border border-success",children:[e.jsxDEV("span",{className:"text-sm text-success",children:"Pontos resgatados"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:925,columnNumber:21},this),e.jsxDEV("span",{className:"font-semibold text-success",children:[r.loyaltyPointsRedeemed," pts = -",c(r.loyaltyDiscountAmount||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:926,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:924,columnNumber:19},this),!r.loyaltyPointsRedeemed&&p.loyaltyPoints>=(E.minPointsToRedeem||100)&&e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(L,{className:"text-xs",children:["Resgatar pontos (min: ",E.minPointsToRedeem,")"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:934,columnNumber:21},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(k,{type:"number",placeholder:"Pontos",value:Q||"",onChange:s=>Ne(Number(s.target.value)),min:E.minPointsToRedeem||100,max:p.loyaltyPoints,"data-testid":"input-loyalty-points"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:936,columnNumber:23},this),e.jsxDEV(n,{onClick:()=>we.mutate(Q),disabled:!Q||Q<(E.minPointsToRedeem||100)||we.isPending,"data-testid":"button-redeem-loyalty",children:"Resgatar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:945,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:935,columnNumber:21},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:["Desconto: ",c((Q||0)*parseFloat(E.currencyPerPoint||"0"))]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:953,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:933,columnNumber:19},this),e.jsxDEV("div",{className:"flex items-center justify-between p-2 rounded-md bg-primary/10 border border-primary",children:[e.jsxDEV("span",{className:"text-sm",children:"Pontos a ganhar neste pedido"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:960,columnNumber:19},this),e.jsxDEV("span",{className:"font-semibold text-primary",children:["+",Math.floor(parseFloat(((ke=r.totalAmount)==null?void 0:ke.toString())||"0")*parseFloat(E.pointsPerCurrency||"1"))," pts"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:961,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:959,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:917,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:910,columnNumber:15},this),r.orderType==="mesa"&&r.tableId&&e.jsxDEV(y,{className:"border-purple-500/20",children:[e.jsxDEV(A,{className:"pb-3",children:e.jsxDEV(I,{className:"text-lg flex items-center gap-2",children:[e.jsxDEV(M,{className:"h-5 w-5 text-purple-500"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:974,columnNumber:19},this),"Op√ß√µes de Mesa"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:973,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:972,columnNumber:15},this),e.jsxDEV(V,{className:"space-y-4",children:[be&&((Ee=x==null?void 0:x.ordersByGuest)==null?void 0:Ee.length)>0&&e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV(L,{className:"text-sm font-semibold",children:"Pagamento por Cliente"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:982,columnNumber:21},this),e.jsxDEV("div",{className:"space-y-2",children:x.ordersByGuest.map(s=>{var a,o;return e.jsxDEV(y,{className:"border-purple-500/20 bg-purple-50/50 dark:bg-purple-950/20",children:e.jsxDEV(V,{className:"p-4 space-y-3",children:[e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-semibold",children:s.guest.name||`Cliente #${s.guest.guestNumber}`},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:989,columnNumber:33},this),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:[((a=s.orders)==null?void 0:a.length)||0," ",((o=s.orders)==null?void 0:o.length)===1?"item":"itens"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:992,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:988,columnNumber:31},this),e.jsxDEV("p",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:c(s.totalAmount||0)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:996,columnNumber:31},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:987,columnNumber:29},this),e.jsxDEV(P,{},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1001,columnNumber:29},this),e.jsxDEV(or,{guest:s.guest,orders:s.orders,totalAmount:s.totalAmount,table:{id:r.tableId,number:r.tableNumber||0,capacity:0,status:"occupied",restaurantId:r.restaurantId,branchId:r.branchId||null,qrCode:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},restaurantName:(ie==null?void 0:ie.name)||"",children:e.jsxDEV(n,{variant:"outline",size:"sm",className:"w-full",children:[e.jsxDEV(cr,{className:"w-4 h-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1026,columnNumber:33},this),"Imprimir Fatura do Cliente"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1021,columnNumber:31},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1004,columnNumber:29},this),e.jsxDEV(P,{},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1031,columnNumber:29},this),e.jsxDEV("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxDEV(n,{variant:"outline",size:"sm",onClick:()=>U(s.guest.id,"dinheiro"),disabled:S.isPending,className:"h-auto py-2 flex-col gap-1",children:[e.jsxDEV("span",{className:"text-lg",children:"üíµ"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1041,columnNumber:33},this),e.jsxDEV("span",{className:"text-xs",children:"Dinheiro"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1042,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1034,columnNumber:31},this),e.jsxDEV(n,{variant:"outline",size:"sm",onClick:()=>U(s.guest.id,"cartao"),disabled:S.isPending,className:"h-auto py-2 flex-col gap-1",children:[e.jsxDEV("span",{className:"text-lg",children:"üí≥"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1051,columnNumber:33},this),e.jsxDEV("span",{className:"text-xs",children:"Cart√£o"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1052,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1044,columnNumber:31},this),e.jsxDEV(n,{variant:"outline",size:"sm",onClick:()=>U(s.guest.id,"mbway"),disabled:S.isPending,className:"h-auto py-2 flex-col gap-1",children:[e.jsxDEV("span",{className:"text-lg",children:"üì±"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1061,columnNumber:33},this),e.jsxDEV("span",{className:"text-xs",children:"MBWay"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1062,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1054,columnNumber:31},this),e.jsxDEV(n,{variant:"outline",size:"sm",onClick:()=>U(s.guest.id,"transferencia"),disabled:S.isPending,className:"h-auto py-2 flex-col gap-1",children:[e.jsxDEV("span",{className:"text-lg",children:"üè¶"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1071,columnNumber:33},this),e.jsxDEV("span",{className:"text-xs",children:"Transfer√™ncia"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1072,columnNumber:33},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1064,columnNumber:31},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1033,columnNumber:29},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:986,columnNumber:27},this)},s.guest.id,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:985,columnNumber:25},this)})},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:983,columnNumber:21},this),e.jsxDEV(P,{},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1079,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:981,columnNumber:19},this),!be&&e.jsxDEV("div",{className:"text-center py-4 text-sm text-muted-foreground",children:[e.jsxDEV(M,{className:"h-8 w-8 mx-auto mb-2 opacity-50"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1086,columnNumber:21},this),e.jsxDEV("p",{children:"Nenhum cliente registrado nesta mesa"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1087,columnNumber:21},this),e.jsxDEV("p",{className:"text-xs mt-1",children:"Use o pagamento padr√£o abaixo para fechar a conta"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1088,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1085,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:978,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:971,columnNumber:13},this),e.jsxDEV(y,{className:"border-primary/20",children:[e.jsxDEV(A,{className:"pb-3",children:e.jsxDEV(I,{className:"text-lg",children:"Resumo do Pedido"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1097,columnNumber:15},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1096,columnNumber:13},this),e.jsxDEV(V,{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("div",{className:"flex justify-between items-center",children:[e.jsxDEV("span",{className:"text-sm text-muted-foreground",children:["Subtotal (",r.orderItems.length," ",r.orderItems.length===1?"item":"itens",")"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1102,columnNumber:19},this),e.jsxDEV("span",{className:"font-medium","data-testid":"text-subtotal",children:c(r.subtotal)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1103,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1101,columnNumber:17},this),e.jsxDEV(P,{},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1106,columnNumber:17},this),e.jsxDEV("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxDEV(q,{children:[e.jsxDEV(R,{asChild:!0,children:e.jsxDEV(n,{variant:"outline",size:"sm",className:"flex-col h-auto py-3 gap-1","data-testid":"button-discount",children:[e.jsxDEV(Ze,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1112,columnNumber:25},this),e.jsxDEV("span",{className:"text-xs",children:"Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1113,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1111,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1110,columnNumber:21},this),e.jsxDEV(K,{children:[e.jsxDEV(F,{children:e.jsxDEV($,{children:"Aplicar Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1118,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1117,columnNumber:23},this),e.jsxDEV(xr,{onSubmit:s=>Me.mutate(s),currentDiscount:Number(r.discount||0),currentType:r.discountType||"valor"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1120,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1116,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1109,columnNumber:19},this),e.jsxDEV(q,{children:[e.jsxDEV(R,{asChild:!0,children:e.jsxDEV(n,{variant:"outline",size:"sm",className:"flex-col h-auto py-3 gap-1","data-testid":"button-service",children:[e.jsxDEV(er,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1131,columnNumber:25},this),e.jsxDEV("span",{className:"text-xs",children:"Servi√ßo"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1132,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1130,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1129,columnNumber:21},this),e.jsxDEV(K,{children:[e.jsxDEV(F,{children:e.jsxDEV($,{children:"Taxa de Servi√ßo"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1137,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1136,columnNumber:23},this),e.jsxDEV(fr,{onSubmit:s=>Le.mutate(s),currentCharge:Number(r.serviceCharge||0),currentName:r.serviceName||""},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1139,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1135,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1128,columnNumber:19},this),e.jsxDEV(q,{children:[e.jsxDEV(R,{asChild:!0,children:e.jsxDEV(n,{variant:"outline",size:"sm",className:"flex-col h-auto py-3 gap-1","data-testid":"button-packaging",children:[e.jsxDEV(dr,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1150,columnNumber:25},this),e.jsxDEV("span",{className:"text-xs",children:"Embalagem"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1151,columnNumber:25},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1149,columnNumber:23},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1148,columnNumber:21},this),e.jsxDEV(K,{children:[e.jsxDEV(F,{children:e.jsxDEV($,{children:"Taxa de Embalagem"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1156,columnNumber:25},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1155,columnNumber:23},this),e.jsxDEV(gr,{onSubmit:s=>Be.mutate(s),currentFee:Number(r.packagingFee||0)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1158,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1154,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1147,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1108,columnNumber:17},this),Number(r.discount||0)>0&&e.jsxDEV(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex justify-between text-sm bg-destructive/10 p-2 rounded-md",children:[e.jsxDEV("span",{className:"text-destructive font-medium",children:["Desconto ",r.discountType==="percentual"?`(${r.discount}%)`:""]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1172,columnNumber:21},this),e.jsxDEV("span",{className:"text-destructive font-semibold",children:["-",c(r.discount||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1175,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1167,columnNumber:19},this),Number(r.serviceCharge||0)>0&&e.jsxDEV(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex justify-between text-sm bg-primary/10 p-2 rounded-md",children:[e.jsxDEV("span",{className:"text-primary font-medium",children:["Taxa de Servi√ßo",r.serviceName?` (${r.serviceName})`:""]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1185,columnNumber:21},this),e.jsxDEV("span",{className:"text-primary font-semibold",children:["+",c(r.serviceCharge||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1188,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1180,columnNumber:19},this),Number(r.packagingFee||0)>0&&e.jsxDEV(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex justify-between text-sm bg-primary/10 p-2 rounded-md",children:[e.jsxDEV("span",{className:"text-primary font-medium",children:"Embalagem"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1198,columnNumber:21},this),e.jsxDEV("span",{className:"text-primary font-semibold",children:["+",c(r.packagingFee||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1199,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1193,columnNumber:19},this),r.couponDiscount&&Number(r.couponDiscount)>0&&e.jsxDEV(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex justify-between text-sm bg-success/10 p-2 rounded-md",children:[e.jsxDEV("span",{className:"text-success font-medium",children:"Cupom de Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1209,columnNumber:21},this),e.jsxDEV("span",{className:"text-success font-semibold",children:["-",c(r.couponDiscount||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1210,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1204,columnNumber:19},this),r.loyaltyDiscountAmount&&Number(r.loyaltyDiscountAmount)>0&&e.jsxDEV(w.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex justify-between text-sm bg-success/10 p-2 rounded-md",children:[e.jsxDEV("span",{className:"text-success font-medium",children:"Pontos Resgatados"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1220,columnNumber:21},this),e.jsxDEV("span",{className:"text-success font-semibold",children:["-",c(r.loyaltyDiscountAmount||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1221,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1215,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1100,columnNumber:15},this),e.jsxDEV(P,{className:"my-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1226,columnNumber:15},this),e.jsxDEV(w.div,{className:"bg-primary/5 border-2 border-primary/20 rounded-lg p-4",animate:{borderColor:r.paymentStatus==="pago"?["hsl(var(--primary) / 0.2)","hsl(var(--primary) / 0.4)","hsl(var(--primary) / 0.2)"]:"hsl(var(--primary) / 0.2)"},transition:{duration:2,repeat:r.paymentStatus==="pago"?1/0:0},children:[e.jsxDEV("div",{className:"flex justify-between items-center mb-2",children:[e.jsxDEV("span",{className:"text-sm font-medium text-muted-foreground",children:"TOTAL A PAGAR"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1241,columnNumber:19},this),e.jsxDEV(O,{className:r.paymentStatus==="pago"?"bg-chart-3 text-chart-3-foreground":r.paymentStatus==="parcial"?"bg-chart-4 text-chart-4-foreground":"bg-chart-1 text-chart-1-foreground",children:r.paymentStatus==="pago"?"‚úì Pago":r.paymentStatus==="parcial"?"Parcial":"Pendente"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1242,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1240,columnNumber:17},this),e.jsxDEV("div",{className:"flex justify-between items-center mb-3",children:e.jsxDEV("span",{className:"text-3xl font-bold text-primary","data-testid":"text-total",children:c(r.totalAmount)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1255,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1254,columnNumber:17},this),r.paymentStatus==="parcial"&&e.jsxDEV("div",{className:"mb-3 pb-3 border-b border-primary/20",children:[e.jsxDEV("div",{className:"flex justify-between text-sm",children:[e.jsxDEV("span",{className:"text-muted-foreground",children:"Pago:"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1263,columnNumber:23},this),e.jsxDEV("span",{className:"font-medium",children:c(r.paidAmount||0)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1264,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1262,columnNumber:21},this),e.jsxDEV("div",{className:"flex justify-between text-sm font-semibold mt-1",children:[e.jsxDEV("span",{children:"Restante:"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1267,columnNumber:23},this),e.jsxDEV("span",{className:"text-destructive",children:c(Number(r.totalAmount)-Number(r.paidAmount||0))},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1268,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1266,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1261,columnNumber:19},this),r.paymentStatus!=="pago"&&r.orderItems.length>0&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(n,{className:"w-full h-12 text-lg font-semibold",size:"lg","data-testid":"button-pay-summary",onClick:()=>C(!0),children:[e.jsxDEV(ye,{className:"h-5 w-5 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1281,columnNumber:23},this),r.paymentStatus==="parcial"?`Pagar ${c(Number(r.totalAmount)-Number(r.paidAmount||0))}`:`Pagar ${c(r.totalAmount)}`]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1275,columnNumber:21},this),e.jsxDEV(Nr,{open:Fe,onOpenChange:C,totalAmount:Number(r.totalAmount),paidAmount:Number(r.paidAmount||0),isSubmitting:S.isPending,onSubmit:s=>S.mutate(s),title:"Registrar Pagamento"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1288,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1274,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1228,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1099,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1095,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:584,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:583,columnNumber:7},this),e.jsxDEV("div",{className:"border-t p-4 flex gap-2",children:[e.jsxDEV(n,{variant:"outline",onClick:()=>u("/pdv"),"data-testid":"button-back",children:[e.jsxDEV(le,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1311,columnNumber:11},this),"Voltar"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1306,columnNumber:9},this),r.cancellationReason&&r.cancellationReason!==""?e.jsxDEV("div",{className:"flex-1 flex items-center justify-center gap-2 text-destructive border border-destructive rounded-md px-4 py-2 bg-destructive/10",children:[e.jsxDEV(Ve,{className:"h-4 w-4"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1317,columnNumber:13},this),e.jsxDEV("span",{className:"font-medium",children:"Pedido Cancelado"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1318,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1316,columnNumber:11},this):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(q,{open:Qe,onOpenChange:Z,children:[e.jsxDEV(R,{asChild:!0,children:e.jsxDEV(n,{variant:"destructive",disabled:z.isPending,"data-testid":"button-cancel-order",children:[e.jsxDEV(Ve,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1329,columnNumber:19},this),"Cancelar Pedido"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1324,columnNumber:17},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1323,columnNumber:15},this),e.jsxDEV(K,{children:[e.jsxDEV(F,{children:e.jsxDEV($,{children:"Cancelar Pedido"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1335,columnNumber:19},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1334,columnNumber:17},this),e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(L,{children:"Motivo do Cancelamento *"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1339,columnNumber:21},this),e.jsxDEV(k,{placeholder:"Ex: Cliente desistiu, produto indispon√≠vel, etc.",value:ee,onChange:s=>re(s.target.value),"data-testid":"input-cancellation-reason"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1340,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1338,columnNumber:19},this),Number(r.paidAmount||0)>0&&e.jsxDEV("div",{className:"p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:[e.jsxDEV("p",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-400",children:["‚ö†Ô∏è Este pedido possui pagamento de ",c(r.paidAmount||0)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1350,columnNumber:23},this),e.jsxDEV("p",{className:"text-xs text-yellow-600 dark:text-yellow-500 mt-1",children:"O valor ser√° estornado automaticamente nas transa√ß√µes financeiras"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1353,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1349,columnNumber:21},this),r.loyaltyPointsEarned&&r.loyaltyPointsEarned>0&&e.jsxDEV("div",{className:"p-3 bg-blue-500/10 border border-blue-500/20 rounded-md",children:[e.jsxDEV("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-400",children:["‚ÑπÔ∏è Este pedido gerou ",r.loyaltyPointsEarned," pontos de fidelidade"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1361,columnNumber:23},this),e.jsxDEV("p",{className:"text-xs text-blue-600 dark:text-blue-500 mt-1",children:"Os pontos ser√£o estornados automaticamente do cliente"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1364,columnNumber:23},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1360,columnNumber:21},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(n,{variant:"outline",onClick:()=>{Z(!1),re("")},disabled:z.isPending,"data-testid":"button-cancel-dialog",className:"flex-1",children:"Voltar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1371,columnNumber:21},this),e.jsxDEV(n,{variant:"destructive",onClick:()=>z.mutate(ee),disabled:!ee||z.isPending,"data-testid":"button-confirm-cancel",className:"flex-1",children:z.isPending?"Cancelando...":"Confirmar Cancelamento"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1383,columnNumber:21},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1370,columnNumber:19},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1337,columnNumber:17},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1333,columnNumber:15},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1322,columnNumber:13},this),e.jsxDEV(n,{variant:"default",className:"flex-1",disabled:r.orderItems.length===0||r.paymentStatus==="pago","data-testid":"button-pay",onClick:()=>C(!0),children:[e.jsxDEV(ye,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1404,columnNumber:15},this),"Pagar"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1397,columnNumber:13},this),e.jsxDEV(n,{variant:"default",className:"flex-1",disabled:r.orderItems.length===0||r.status!=="pendente",onClick:()=>Ue.mutate("em_preparo"),"data-testid":"button-accept",children:[e.jsxDEV(G,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1414,columnNumber:15},this),"Aceitar"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1407,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1321,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1305,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:511,columnNumber:5},this):e.jsxDEV("div",{className:"flex flex-col items-center justify-center h-screen gap-4",children:[e.jsxDEV("p",{className:"text-muted-foreground",children:"Pedido n√£o encontrado"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:501,columnNumber:9},this),e.jsxDEV(n,{onClick:()=>u("/pdv"),"data-testid":"button-back-to-pdv",children:[e.jsxDEV(le,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:503,columnNumber:11},this),"Voltar ao PDV"]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:502,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:500,columnNumber:7},this)}function xr({onSubmit:h,currentDiscount:u,currentType:t}){const[i,g]=m.useState(u.toString()),[v,D]=m.useState(t);return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(L,{children:"Tipo de Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1439,columnNumber:9},this),e.jsxDEV(Ce,{value:v,onValueChange:b=>D(b),children:[e.jsxDEV(Se,{"data-testid":"select-discount-type",children:e.jsxDEV(Te,{},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1442,columnNumber:13},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1441,columnNumber:11},this),e.jsxDEV(Ae,{children:[e.jsxDEV(oe,{value:"valor",children:"Valor Fixo"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1445,columnNumber:13},this),e.jsxDEV(oe,{value:"percentual",children:"Percentual"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1446,columnNumber:13},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1444,columnNumber:11},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1440,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1438,columnNumber:7},this),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(L,{children:"Valor do Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1451,columnNumber:9},this),e.jsxDEV(k,{type:"number",value:i,onChange:b=>g(b.target.value),placeholder:"0.00","data-testid":"input-discount-value"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1452,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1450,columnNumber:7},this),e.jsxDEV(n,{onClick:()=>h({discount:i,discountType:v}),className:"w-full","data-testid":"button-apply-discount",children:"Aplicar Desconto"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1460,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1437,columnNumber:5},this)}function fr({onSubmit:h,currentCharge:u,currentName:t}){const[i,g]=m.useState(u.toString()),[v,D]=m.useState(t);return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:e.jsxDEV(k,{type:"text",value:v,onChange:b=>D(b.target.value),placeholder:"Nome (opcional)","data-testid":"input-service-name"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1486,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1485,columnNumber:7},this),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1495,columnNumber:9},this),e.jsxDEV(k,{type:"number",value:i,onChange:b=>g(b.target.value),placeholder:"0",className:"pl-8","data-testid":"input-service-charge"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1496,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1494,columnNumber:7},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(n,{variant:"ghost",onClick:()=>{g(u.toString()),D(t)},className:"flex-1","data-testid":"button-cancel-service",children:"Cancelar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1506,columnNumber:9},this),e.jsxDEV(n,{onClick:()=>h({serviceCharge:i,serviceName:v||void 0}),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white","data-testid":"button-apply-service",children:"Confirmar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1517,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1505,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1484,columnNumber:5},this)}function gr({onSubmit:h,currentFee:u}){const[t,i]=m.useState(u.toString());return e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{children:e.jsxDEV(k,{type:"number",value:t,onChange:g=>i(g.target.value),placeholder:"0","data-testid":"input-packaging-fee"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1541,columnNumber:9},this)},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1540,columnNumber:7},this),e.jsxDEV("div",{className:"flex gap-2",children:[e.jsxDEV(n,{variant:"ghost",onClick:()=>i(u.toString()),className:"flex-1","data-testid":"button-cancel-packaging",children:"Cancelar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1550,columnNumber:9},this),e.jsxDEV(n,{onClick:()=>h(t),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white","data-testid":"button-apply-packaging",children:"Confirmar"},void 0,!1,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1558,columnNumber:9},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1549,columnNumber:7},this)]},void 0,!0,{fileName:"/home/runner/workspace/client/src/pages/order-detail.tsx",lineNumber:1539,columnNumber:5},this)}export{zr as default};
